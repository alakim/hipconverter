<html>
<head>
	<style type="text/css">
	#out{
		border: 1px solid #000088;
		padding:4px;
		font-family: courier, monospace;
	}
	</style>
	<script type="text/javascript" src="testTable.js"></script>
	<script type="text/javascript" src="sampleText.js"></script>
	<script type="text/javascript">
	
	function Converter(table){
		var re = [];
		var args = ["$0"];
		var bodyCode = ["return "];
		
		var idx = 1;
		for(var k in table){
			re.push("("+k+")");
			args.push("$"+idx);
			bodyCode.push("$"+idx+"?\""+table[k]+"\":");
			idx++;
		}
		bodyCode.push("0;");
		
		re = new RegExp(re.join("|"), "g");
		args = args.join(",");
		bodyCode = bodyCode.join("");
		
		this.regex = re;
		this.replacement = new Function(args, bodyCode);
		
		this.convert = function(str){
			return str.replace(this.regex, this.replacement);
		}
	}
	
	function writeLine(str){
		document.getElementById("out").innerHTML+=str+"<br>";
	}
	
	function test(){
		var conv = new Converter(testTable);
		var t1 = new Date();
		var res = conv.convert(sampleText);
		var t2 = new Date();
		writeLine("Sample text: "+sampleText.length+" symbols");
		writeLine("dT: "+((t2.getTime() - t1.getTime())/1000)+" sec");
	}
	</script>
</head>
<body>
	<h1>Single Regex Mode</h1>
	<button onclick="test()">Run test</button>
	<div id="out"></div>
</body>
</html>